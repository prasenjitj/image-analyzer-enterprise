# Enterprise Image Processing Configuration
# Copy this file to .env and configure your settings

# =============================================================================
# API Backend Selection
# =============================================================================
# Options: "openrouter" (default) or "legacy"
# - openrouter: Uses OpenRouter.ai with vision models (recommended)
# - legacy: Uses custom API endpoint (e.g., self-hosted vLLM)
API_BACKEND=openrouter

# =============================================================================
# OpenRouter API Configuration (used when API_BACKEND=openrouter)
# =============================================================================
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_MODEL=qwen/qwen-2.5-vl-7b-instruct
OPENROUTER_PRESET=@preset/identify-storefront
OPENROUTER_REFERER=https://your-site.example.com
OPENROUTER_SITE_TITLE=Enterprise Image Analyzer

# =============================================================================
# Legacy API Configuration (used when API_BACKEND=legacy)
# =============================================================================
# Single endpoint (simple setup)
LEGACY_API_ENDPOINT=http://localhost:8000/generate

# Multiple endpoints for load balancing (comma-separated, for multi-GPU setups)
# If set, this takes precedence over LEGACY_API_ENDPOINT
# Example: dual GPU servers on different ports
LEGACY_API_ENDPOINTS=http://localhost:8000/generate,http://localhost:8001/generate

# Optional API key for authentication
LEGACY_API_KEY=

# =============================================================================
# PostgreSQL Database Configuration
# =============================================================================
DATABASE_URL=postgresql://postgres:your_password_here@localhost:5432/imageprocessing

# Alternative: Individual variables (DATABASE_URL takes precedence)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=imageprocessing
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_password_here

# Database Pool Settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30

# =============================================================================
# Redis Configuration
# =============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# =============================================================================
# Processing Configuration
# =============================================================================
CHUNK_SIZE=500
MAX_CONCURRENT_BATCHES=5
MAX_CONCURRENT_WORKERS=16
MAX_CONCURRENT_REQUESTS=16
REQUEST_TIMEOUT=90
RETRY_ATTEMPTS=2
RETRY_DELAY=1.0

# Rate Limiting
REQUESTS_PER_MINUTE=800

# =============================================================================
# Application Configuration
# =============================================================================
SECRET_KEY=your-secret-key-change-in-production
MAX_UPLOAD_SIZE=104857600
DEBUG=false
DEVELOPMENT_MODE=false

# Directories
UPLOAD_DIR=./uploads
EXPORT_DIR=./exports
LOG_DIR=./logs
TEMP_DIR=./temp

# =============================================================================
# Memory & Performance
# =============================================================================
MEMORY_LIMIT_GB=8
GC_FREQUENCY=1000
CONNECTION_POOL_SIZE=100
ENABLE_KEEPALIVE=true

# Prefetch settings
ENABLE_PREFETCH=true
PREFETCH_QUEUE_SIZE=20
PREFETCH_CONCURRENT_DOWNLOADS=10

# =============================================================================
# Store Front Match Configuration
# =============================================================================
STORE_FRONT_MATCH_THRESHOLD_MATCH=80
STORE_FRONT_MATCH_THRESHOLD_PARTIAL=70
STORE_FRONT_MATCH_USE_RAPIDFUZZ=true
